---
name: docs-spec
description: プロジェクト仕様書（.docs/spec.md）の作成・更新・再構成を行う
tools: Read, Write, Edit, Glob, Grep, AskUserQuestion, TodoWrite, Bash
user-invocable: true
---

# docs-spec - プロジェクト仕様書管理

プロジェクトの要件定義から技術設計までを一元管理するドキュメント。
What（何を作るか）と How（どう作るか）を1つのファイルで管理する。

## パラメータの受け取り方

```
/docs-spec action={操作} [ユーザーからの指示・追加情報]
```

### {action}: 操作内容

| action | 操作内容 |
|--------|------|
| create | 新規作成 |
| update | 更新・編集 |
| restructure | 既存の内容にとらわれず、ゼロベースで再構成 |


## 実行フロー

### 1. 事前情報の確認

ユーザーからの要望や参考すべき文書・情報が指定されているはずなので、必ず確認します。


### 2. ドキュメントの作成・編集

以下のフォーマットに従って `.docs/spec.md` を {action} します。


### 3. 一度コミットする

ドキュメントを {action} したら、git commit します。


### 4. Codex による最終レビュー

以下を実行して、完成したドキュメントを Codex にレビューさせ、修正指示があれば参考にして修正してください。

```
/codex-review --auto-commit
```


---

## フォーマット仕様

出力先: `.docs/spec.md`

### 6セクション構成

1. **概要** - 目的、対象ユーザー
2. **機能要件** - Must/Should/Could + MVP列
3. **技術スタック** - 使用技術と選定理由
4. **アーキテクチャ** - ディレクトリ構成、コンポーネント
5. **インターフェース** - API設計、データモデル
6. **制約** - 非機能要件、規約、スコープ外

### 記述方針

- **簡潔さを優先**し、冗長な説明は避ける
- 技術選定には必ず理由を明記する
- 機能要件には ID を採番し、設計セクションから参照可能にする
- コード例は基本は不要。書いても最小限に。「どこに何があるか」が分かれば十分。


---

## テンプレート

```markdown
# プロジェクト仕様書

## 1. 概要

### 目的
{このプロジェクトで解決したい課題・達成したいこと}

### 対象ユーザー
{誰が使うのか}


## 2. 機能要件

| ID | 機能名 | 説明 | 優先度 | MVP |
|----|--------|------|--------|-----|
| FR-001 | {機能名} | {何ができるか} | Must | ✓ |
| FR-002 | {機能名} | {何ができるか} | Must | ✓ |
| FR-003 | {機能名} | {何ができるか} | Should | - |
| FR-004 | {機能名} | {何ができるか} | Could | - |

**優先度**: Must（必須）/ Should（推奨）/ Could（任意）


## 3. 技術スタック

| カテゴリ | 技術 | 選定理由 |
|----------|------|----------|
| 言語 | {言語名} | {理由} |
| フレームワーク | {FW名} | {理由} |
| DB | {DB名} | {理由} |


## 4. アーキテクチャ

### ディレクトリ構成

\`\`\`
{project-name}/
├── src/
│   ├── {dir}/     # {役割}
│   └── ...
├── tests/
└── ...
\`\`\`

### コンポーネント構成

{主要コンポーネント間の関係を説明}


## 5. インターフェース

### API 設計
<!-- Web API がある場合 -->

| Method | Path | 説明 | 対応要件 |
|--------|------|------|----------|
| GET | /api/xxx | {処理内容} | FR-001 |

### データモデル
<!-- DB やデータ構造がある場合 -->

| モデル名 | 主要フィールド | 説明 |
|----------|---------------|------|
| {Model} | id, name, ... | {役割} |


## 6. 制約

### 非機能要件

| ID | カテゴリ | 要件 |
|----|----------|------|
| NFR-001 | パフォーマンス | {具体的な数値目標} |
| NFR-002 | セキュリティ | {必要なセキュリティ対策} |

### コーディング規約

- {命名規則、フォーマットなど}

### スコープ外

- {明示的に対応しないこと}
```


---

## 書き方としてよくある間違い

| NG | OK | 理由 |
|----|-----|------|
| 「使いやすいUI」 | 「3クリック以内で完了」 | 要件は検証可能な形で書く |
| 全機能を Must に | Must は本当に必須なものだけ | 優先度が機能しなくなる |
| 理由なく技術を列挙 | 選定理由を必ず記載 | 後で「なぜこれ？」となる |
| 全ファイルを列挙 | 主要構成のみ記載 | 詳細すぎると保守が困難 |
| コードを仕様書に転記 | ファイルパスと概要のみ | 二重管理になる |
